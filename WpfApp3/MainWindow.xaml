<Window x:Class="WpfApp3.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:WpfApp3"
        xmlns:wpf="clr-namespace:Microsoft.Web.WebView2.Wpf;assembly=Microsoft.Web.WebView2.Wpf"
        mc:Ignorable="d"
        Title="R Classroom" Height="800" Width="1200"
        WindowStartupLocation="CenterScreen"
        Background="Transparent"
        AllowsTransparency="True"
        WindowStyle="None"
        ResizeMode="CanResizeWithGrip">
    <Window.Resources>
        <!-- White Theme Brushes -->
        <SolidColorBrush x:Key="WhiteBackgroundBrush" Color="White"/>
        <SolidColorBrush x:Key="TransparentBrush" Color="Transparent"/>
        <SolidColorBrush x:Key="LightGrayBrush" Color="#FFEEEEEE"/>
        <SolidColorBrush x:Key="MediumGrayBrush" Color="#FFCCCCCC"/>
        <SolidColorBrush x:Key="DarkGrayBrush" Color="#FF333333"/>
        <SolidColorBrush x:Key="DimGrayBrush" Color="#FF696969"/>
        <SolidColorBrush x:Key="BlackBrush" Color="Black"/>
        <SolidColorBrush x:Key="BlueBrush" Color="#FF0078D4"/>
        <SolidColorBrush x:Key="LightBlueBrush" Color="#FFB3E5FC"/>
        <SolidColorBrush x:Key="NewTabButtonColor" Color="#AFEEEE"/>
        <SolidColorBrush x:Key="ClearOutputButtonColor" Color="#FFB6B6"/>
        <!-- Notebook Paper Texture -->
        <DrawingBrush x:Key="NotebookPaperTexture" TileMode="Tile" Viewport="0,0,100,100" ViewportUnits="Absolute">
            <DrawingBrush.Drawing>
                <DrawingGroup>
                    <GeometryDrawing Brush="White">
                        <GeometryDrawing.Geometry>
                            <RectangleGeometry Rect="0,0,100,100"/>
                        </GeometryDrawing.Geometry>
                    </GeometryDrawing>
                    <GeometryDrawing>
                        <GeometryDrawing.Geometry>
                            <RectangleGeometry Rect="0,25,100,0.5"/>
                        </GeometryDrawing.Geometry>
                        <GeometryDrawing.Brush>
                            <SolidColorBrush Color="#FFD0CECE" Opacity="0.5"/>
                        </GeometryDrawing.Brush>
                    </GeometryDrawing>
                    <GeometryDrawing>
                        <GeometryDrawing.Geometry>
                            <RectangleGeometry Rect="0,50,100,0.5"/>
                        </GeometryDrawing.Geometry>
                        <GeometryDrawing.Brush>
                            <SolidColorBrush Color="#FFD0CECE" Opacity="0.5"/>
                        </GeometryDrawing.Brush>
                    </GeometryDrawing>
                    <GeometryDrawing>
                        <GeometryDrawing.Geometry>
                            <RectangleGeometry Rect="0,75,100,0.5"/>
                        </GeometryDrawing.Geometry>
                        <GeometryDrawing.Brush>
                            <SolidColorBrush Color="#FFD0CECE" Opacity="0.5"/>
                        </GeometryDrawing.Brush>
                    </GeometryDrawing>
                    <GeometryDrawing>
                        <GeometryDrawing.Geometry>
                            <RectangleGeometry Rect="15,0,0.5,100"/>
                        </GeometryDrawing.Geometry>
                        <GeometryDrawing.Brush>
                            <SolidColorBrush Color="#FFA8A5A5" Opacity="0.7"/>
                        </GeometryDrawing.Brush>
                    </GeometryDrawing>
                </DrawingGroup>
            </DrawingBrush.Drawing>
        </DrawingBrush>
        <!-- Notebook Tab Style - Updated with transparency -->
        <Style x:Key="NotebookTabStyle" TargetType="TabItem">
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="TabItem">
                        <Grid Name="Panel" Margin="0,0,5,0">
                            <Grid>
                                <Border Name="Border"
                                Background="White"
                                BorderBrush="LightGray"
                                BorderThickness="1,1,1,0"
                                CornerRadius="8,8,0,0"
                                Padding="10,4"  
                                    Height="35">
                                    <Border.Effect>
                                        <DropShadowEffect Color="#FF87CEEB" 
                                                  ShadowDepth="2" 
                                                  Direction="315" 
                                                  BlurRadius="4" 
                                                  Opacity="0.3"/>
                                    </Border.Effect>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="Auto"/>
                                        </Grid.ColumnDefinitions>
                                        <StackPanel Grid.Column="0" Orientation="Horizontal">
                                            <TextBlock x:Name="TabText" 
                                               Text="{TemplateBinding Header}" 
                                               VerticalAlignment="Center" 
                                               FontWeight="Medium"
                                               FontFamily="Comic Neue, Kalam"
                                               FontSize="12"    
                                               Foreground="{StaticResource DarkGrayBrush}"/>
                                            <TextBlock x:Name="ModifiedIndicator" 
                                               Text=" *" 
                                               VerticalAlignment="Center" 
                                               FontWeight="Bold"
                                               FontFamily="Comic Neue, Kalam"
                                               FontSize="12"   
                                               Foreground="{StaticResource BlueBrush}"
                                               Visibility="Collapsed"/>
                                        </StackPanel>
                                        <Button x:Name="CloseButton"
                                        Grid.Column="1"
                                        Content="✕" 
                                        Width="16"      
                                        Height="16"     
                                        Margin="6,0,0,0" 
                                        VerticalAlignment="Center"
                                        Background="Transparent" 
                                        BorderThickness="0"
                                        Foreground="{StaticResource DarkGrayBrush}"
                                        FontSize="8"    
                                        FontWeight="Bold"
                                        Cursor="Hand"
                                        ToolTip="Close tab">
                                            <Button.Style>
                                                <Style TargetType="Button">
                                                    <Setter Property="Template">
                                                        <Setter.Value>
                                                            <ControlTemplate TargetType="Button">
                                                                <Border Background="{TemplateBinding Background}"
                                                                CornerRadius="8">
                                                                    <!-- Reduced corner radius from 10 to 8 -->
                                                                    <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                                                </Border>
                                                            </ControlTemplate>
                                                        </Setter.Value>
                                                    </Setter>
                                                    <Style.Triggers>
                                                        <Trigger Property="IsMouseOver" Value="True">
                                                            <Setter Property="Background" Value="{StaticResource LightBlueBrush}"/>
                                                            <Setter Property="Foreground" Value="White"/>
                                                        </Trigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </Button.Style>
                                        </Button>
                                    </Grid>
                                </Border>
                                <!-- Torn edge effect -->
                                <Path Grid.ZIndex="-1" 
                              Data="M 0,35 Q 5,30 10,35 T 20,35 T 30,35 T 40,35 T 50,35 T 60,35 T 70,35 T 80,35 T 90,35 T 100,35 T 110,35 T 120,35 T 130,35 T 140,35 T 150,35 T 160,35 T 170,35 T 180,35 T 190,35 T 200,35" 
                              Stroke="{StaticResource BlueBrush}" 
                              StrokeThickness="1" 
                              Fill="Transparent" 
                              VerticalAlignment="Bottom" 
                              Margin="0,0,0,-1"/>
                            </Grid>
                        </Grid>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsSelected" Value="True">
                                <Setter TargetName="Border" Property="Background" Value="#FFE0D1"/>
                                <Setter TargetName="Border" Property="BorderThickness" Value="1,1,1,0"/>
                                <Setter TargetName="TabText" Property="Foreground" Value="gray"/>
                                <Setter TargetName="TabText" Property="FontWeight" Value="Bold"/>
                            </Trigger>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="Border" Property="Background" Value="{StaticResource LightGrayBrush}"/>
                                <Setter TargetName="CloseButton" Property="Foreground" Value="{StaticResource DarkGrayBrush}"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <!-- TabControl Style - Updated with transparency -->
        <Style TargetType="TabControl">
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="TabControl">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>
                            <!-- Tabs Container - Semi-transparent -->
                            <Border Grid.Row="0" 
                                    Background="White"
                                    BorderBrush="Gray"
                                    BorderThickness="0,0,0,2"
                                    Padding="10,5"
                                    CornerRadius="0,0,0,0">
                                <TabPanel x:Name="HeaderPanel"
                                          IsItemsHost="True"
                                          Background="Transparent"
                                          Margin="0,0,0,0"/>
                            </Border>
                            <!-- Tab Content -->
                            <Border Grid.Row="1" 
                                    Background="Transparent"
                                    BorderBrush="Gray"
                                    BorderThickness="2"
                                    CornerRadius="0,12,12,12"
                                    Padding="5">
                                <Border.Effect>
                                    <DropShadowEffect Color="#FF87CEEB" 
                                                      ShadowDepth="3" 
                                                      Direction="315" 
                                                      BlurRadius="8" 
                                                      Opacity="0.2"/>
                                </Border.Effect>
                                <ContentPresenter ContentSource="SelectedContent"/>
                            </Border>
                        </Grid>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <!-- Button Styles -->
        <Style x:Key="ClassroomButton" TargetType="Button">
            <Setter Property="Background" Value="{StaticResource WhiteBackgroundBrush}"/>
            <Setter Property="Foreground" Value="{StaticResource DarkGrayBrush}"/>
            <Setter Property="BorderBrush" Value="{StaticResource MediumGrayBrush}"/>
            <Setter Property="BorderThickness" Value="2"/>
            <Setter Property="Padding" Value="12,6"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="FontWeight" Value="Medium"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="FontFamily" Value="Comic Neue, Kalam"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}"
                                BorderBrush="Gray"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                CornerRadius="12"
                                Padding="{TemplateBinding Padding}">
                            <Border.Effect>
                                <DropShadowEffect Color="#FF87CEEB" 
                                                  ShadowDepth="2" 
                                                  Direction="315" 
                                                  BlurRadius="5" 
                                                  Opacity="0.3"/>
                            </Border.Effect>
                            <Grid>
                                <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                            </Grid>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Background" Value="MediumAquamarine"/>
                                <Setter Property="BorderBrush" Value="Gray"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter Property="Background" Value="{StaticResource LightBlueBrush}"/>
                                <Setter Property="BorderBrush" Value="Gray"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <!-- Action Button Style (Run, Save, etc.) -->
        <Style x:Key="ClassroomActionButton" TargetType="Button" BasedOn="{StaticResource ClassroomButton}">
            <Setter Property="Background" Value="{StaticResource LightBlueBrush}"/>
            <Setter Property="BorderBrush" Value="Gray"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="Padding" Value="15,8"/>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="Gray"/>
                    <Setter Property="BorderBrush" Value="Gray"/>
                </Trigger>
                <Trigger Property="IsPressed" Value="True">
                    <Setter Property="Background" Value="{StaticResource DarkGrayBrush}"/>
                    <Setter Property="BorderBrush" Value="Gray"/>
                </Trigger>
            </Style.Triggers>
        </Style>
        <!-- Copy Button Style -->
        <Style x:Key="CopyButtonStyle" TargetType="Button" BasedOn="{StaticResource ClassroomButton}">
            <Setter Property="Background" Value="{StaticResource LightGrayBrush}"/>
            <Setter Property="BorderBrush" Value="Gray"/>
            <Setter Property="Width" Value="36"/>
            <Setter Property="Height" Value="36"/>
            <Setter Property="Padding" Value="0"/>
            <Setter Property="Margin" Value="5,0"/>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="MediumAquamarine"/>
                    <Setter Property="BorderBrush" Value="DimGray"/>
                </Trigger>
            </Style.Triggers>
        </Style>
        <Style x:Key="SettingButtons" TargetType="Button" BasedOn="{StaticResource ClassroomButton}">
            <Setter Property="Background" Value="{StaticResource LightGrayBrush}"/>
            <Setter Property="BorderBrush" Value="Gray"/>
            <Setter Property="Width" Value="36"/>
            <Setter Property="Height" Value="36"/>
            <Setter Property="Padding" Value="0"/>
            <Setter Property="Margin" Value="5,0"/>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="MediumAquamarine"/>
                    <Setter Property="BorderBrush" Value="DimGray"/>
                </Trigger>
            </Style.Triggers>
        </Style>
        <!-- TextBox Style -->
        <Style TargetType="TextBox">
            <Setter Property="Background" Value="{StaticResource WhiteBackgroundBrush}"/>
            <Setter Property="BorderBrush" Value="{StaticResource MediumGrayBrush}"/>
            <Setter Property="BorderThickness" Value="2"/>
            <Setter Property="Padding" Value="5"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="FontFamily" Value="Consolas, 'Courier New'"/>
            <Setter Property="Foreground" Value="{StaticResource BlackBrush}"/>
            <Setter Property="SelectionBrush" Value="Gray"/>
            <Setter Property="CaretBrush" Value="{StaticResource DarkGrayBrush}"/>
            <Setter Property="VerticalScrollBarVisibility" Value="Auto"/>
            <Setter Property="TextWrapping" Value="NoWrap"/>
            <Setter Property="AcceptsReturn" Value="True"/>
            <Setter Property="AcceptsTab" Value="True"/>
            <Style.Triggers>
                <Trigger Property="IsFocused" Value="True">
                    <Setter Property="BorderBrush" Value="Gray"/>
                    <Setter Property="BorderThickness" Value="3"/>
                </Trigger>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="BorderBrush" Value="{StaticResource MediumGrayBrush}"/>
                </Trigger>
            </Style.Triggers>
        </Style>
        <!-- Console Output Style -->
        <Style x:Key="ConsoleOutputStyle" TargetType="TextBox" BasedOn="{StaticResource {x:Type TextBox}}">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="BorderBrush" Value="{StaticResource MediumGrayBrush}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Foreground" Value="{StaticResource DimGrayBrush}"/>
            <Setter Property="FontFamily" Value="Consolas, 'Courier New'"/>
            <Setter Property="FontSize" Value="13"/>
            <Setter Property="Padding" Value="10"/>
            <Setter Property="TextWrapping" Value="Wrap"/>
            <Setter Property="VerticalScrollBarVisibility" Value="Auto"/>
            <Setter Property="HorizontalScrollBarVisibility" Value="Auto"/>
            <Setter Property="IsReadOnly" Value="True"/>
            <Style.Triggers>
                <Trigger Property="IsFocused" Value="True">
                    <Setter Property="BorderBrush" Value="Gray"/>
                </Trigger>
            </Style.Triggers>
        </Style>
        <!-- Code Editor Style -->
        <Style x:Key="CodeEditorStyle" TargetType="TextBox" BasedOn="{StaticResource {x:Type TextBox}}">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="BorderBrush" Value="{StaticResource MediumGrayBrush}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Foreground" Value="{StaticResource BlackBrush}"/>
            <Setter Property="FontFamily" Value="Consolas, 'Courier New'"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="Padding" Value="20,5,5,5"/>
            <Setter Property="TextWrapping" Value="NoWrap"/>
            <Setter Property="VerticalScrollBarVisibility" Value="Auto"/>
            <Setter Property="HorizontalScrollBarVisibility" Value="Auto"/>
            <Setter Property="AcceptsReturn" Value="True"/>
            <Setter Property="AcceptsTab" Value="True"/>
            <Setter Property="SelectionBrush" Value="{StaticResource BlueBrush}"/>
            <Setter Property="CaretBrush" Value="{StaticResource DarkGrayBrush}"/>
            <Style.Triggers>
                <Trigger Property="IsFocused" Value="True">
                    <Setter Property="BorderBrush" Value="Gray"/>
                </Trigger>
            </Style.Triggers>
        </Style>
        <!-- GridSplitter Style -->
        <Style TargetType="GridSplitter">
            <Setter Property="Background" Value="{StaticResource MediumGrayBrush}"/>
            <Setter Property="Width" Value="8"/>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="{StaticResource BlueBrush}"/>
                    <Setter Property="Effect">
                        <Setter.Value>
                            <DropShadowEffect Color="#FFB3E5FC" 
                                              ShadowDepth="0" 
                                              BlurRadius="8" 
                                              Opacity="0.5"/>
                        </Setter.Value>
                    </Setter>
                </Trigger>
            </Style.Triggers>
        </Style>
        <!-- Title Style -->
        <Style x:Key="ClassroomTitle" TargetType="TextBlock">
            <Setter Property="FontFamily" Value="Kalam, Comic Neue"/>
            <Setter Property="FontSize" Value="24"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="Foreground" Value="{StaticResource DarkGrayBrush}"/>
            <Setter Property="Effect">
                <Setter.Value>
                    <DropShadowEffect Color="#FF87CEEB" 
                                      ShadowDepth="2" 
                                      Direction="315" 
                                      BlurRadius="5" 
                                      Opacity="0.5"/>
                </Setter.Value>
            </Setter>
        </Style>
        <!-- Subtitle Style -->
        <Style x:Key="ClassroomSubtitle" TargetType="TextBlock">
            <Setter Property="FontFamily" Value="Kalam, Comic Neue"/>
            <Setter Property="FontSize" Value="10"/>
            <Setter Property="FontStyle" Value="Italic"/>
            <Setter Property="Foreground" Value="{StaticResource DarkGrayBrush}"/>
            <Setter Property="Margin" Value="5,0,0,0"/>
        </Style>
        <!-- StatusBar Style -->
        <Style x:Key="ClassroomStatusBar" TargetType="StatusBar">
            <Setter Property="Background" Value="{StaticResource WhiteBackgroundBrush}"/>
            <Setter Property="Foreground" Value="{StaticResource DarkGrayBrush}"/>
        </Style>
    </Window.Resources>
    <!-- Main Container with White Theme -->
    <Grid>
        <!-- Background -->
        <Rectangle Fill="White"/>
        <!-- Classroom Style Border -->
        <Border BorderBrush="Gray" 
                BorderThickness="5" 
                Margin="10"
                Background="Transparent"
                CornerRadius="15">
            <Border.Effect>
                <DropShadowEffect Color="#FF87CEEB" 
                                  ShadowDepth="5" 
                                  Direction="315" 
                                  BlurRadius="12" 
                                  Opacity="0.3"/>
            </Border.Effect>
            <Grid>
                <!-- Custom Title Bar -->
                <Grid.RowDefinitions>
                    <RowDefinition Height="60"/>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="40"/>
                </Grid.RowDefinitions>
                <!-- Title Bar with White Style -->
                <Border Grid.Row="0" 
                        Background="MediumAquamarine"
                        BorderBrush="{StaticResource BlueBrush}"
                        BorderThickness="1"
                        CornerRadius="8,8,0,0"
                        MouseLeftButtonDown="TitleBar_MouseLeftButtonDown">
                    <Border.Effect>
                        <DropShadowEffect Color="#FF87CEEB" 
                                          ShadowDepth="2" 
                                          Direction="315" 
                                          BlurRadius="6" 
                                          Opacity="0.2"/>
                    </Border.Effect>
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <!-- App Title -->
                        <StackPanel Grid.Column="0" Orientation="Horizontal" VerticalAlignment="Center">
                            <TextBlock Text="R Classroom"
                                       Style="{StaticResource ClassroomTitle}"
                                       Margin="15,0,0,0"
                                       VerticalAlignment="Center"
                                       Foreground="{StaticResource DarkGrayBrush}"/>
                            <TextBlock Text=" - by prasannova solutions"
                                       FontSize="16"
                                       Style="{StaticResource ClassroomSubtitle}"
                                       Margin="6,0,0,0"
                                       VerticalAlignment="Center"
                                       TextWrapping="NoWrap"/>
                        </StackPanel>
                        <!-- Window Controls -->
                        <StackPanel Grid.Column="1" Orientation="Horizontal" HorizontalAlignment="Right">
                            <Button x:Name="MinimizeButton" 
                                    Content="−" 
                                    Style="{StaticResource ClassroomButton}"
                                    Width="40" 
                                    Height="40" 
                                    Margin="0,5,5,5" 
                                    Click="MinimizeButton_Click"
                                    ToolTip="Minimize"/>
                            <Button x:Name="MaximizeButton" 
                                    Content="□" 
                                    Style="{StaticResource ClassroomButton}"
                                    Width="40" 
                                    Height="40" 
                                    Margin="0,5,5,5" 
                                    Click="MaximizeButton_Click"
                                    ToolTip="Maximize"/>
                            <Button x:Name="CloseButton" 
                                    Content="✕" 
                                    Style="{StaticResource ClassroomButton}"
                                    Width="40" 
                                    Height="40" 
                                    Margin="0,5,10,5" 
                                    Click="CloseButton_Click"
                                    ToolTip="Close"/>
                        </StackPanel>
                    </Grid>
                </Border>
                <!-- Main Content Area -->
                <Grid Grid.Row="1">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                    <!-- Toolbar with White Style -->
                    <Border Grid.Row="0" 
                            Background="FloralWhite"
                            BorderBrush="{StaticResource BlueBrush}" 
                            BorderThickness="0,0,0,3"
                            Margin="10,0,10,5"
                            CornerRadius="0,0,12,12">
                        <Border.Effect>
                            <DropShadowEffect Color="#FF87CEEB" 
                                              ShadowDepth="2" 
                                              Direction="315" 
                                              BlurRadius="6" 
                                              Opacity="0.2"/>
                        </Border.Effect>
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <!-- Left Button Group -->
                            <StackPanel Grid.Column="0" Orientation="Horizontal" Height="40">
                                <Button x:Name="NewTabButton" 
                                        Background="{StaticResource NewTabButtonColor}"
                                        Style="{StaticResource ClassroomButton}"
                                        Margin="10,5,5,5" 
                                        Padding="15,0" 
                                        Click="NewTabButton_Click"
                                        ToolTip="Create a new tab">
                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock Text="📝" FontSize="16" Margin="0,0,5,0"/>
                                        <TextBlock Text="NEW TAB"/>
                                    </StackPanel>
                                </Button>
                                <Button x:Name="SaveButton" 
                                        Style="{StaticResource ClassroomButton}"
                                        Margin="5" 
                                        Padding="15,0" 
                                        Click="SaveButton_Click"
                                        ToolTip="Save current file">
                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock Text="✏️" FontSize="16" Margin="0,0,5,0"/>
                                        <TextBlock Text="SAVE"/>
                                    </StackPanel>
                                </Button>
                                <Button x:Name="LoadButton" 
                                        Style="{StaticResource ClassroomButton}"
                                        Margin="5" 
                                        Padding="15,0" 
                                        Click="LoadButton_Click"
                                        ToolTip="Load a file">
                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock Text="📁" FontSize="16" Margin="0,0,5,0"/>
                                        <TextBlock Text="LOAD"/>
                                    </StackPanel>
                                </Button>
                                <Separator Margin="10,5" Width="3" Background="{StaticResource MediumGrayBrush}"/>
                                <Button x:Name="RunButton" 
                                        Style="{StaticResource ClassroomActionButton}"
                                        Margin="5" 
                                        Padding="15,0" 
                                        Click="RunButton_Click"
                                        ToolTip="Execute R code">
                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock Text="▶️" FontSize="16" Margin="0,0,5,0"/>
                                        <TextBlock Text="RUN (F5)"/>
                                    </StackPanel>
                                </Button>
                                <Button x:Name="ClearButton" 
                                        Background="{StaticResource ClearOutputButtonColor}"
                                        Style="{StaticResource ClassroomButton}"
                                        Margin="5" 
                                        Padding="15,0" 
                                        Click="ClearButton_Click"
                                        ToolTip="Clear output console">
                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock Text="🧹" FontSize="16" Margin="0,0,5,0"/>
                                        <TextBlock Text="CLEAR OUTPUT"/>
                                    </StackPanel>
                                </Button>
                            </StackPanel>
                            <!-- Right Button Group -->
                            <StackPanel Grid.Column="1" Orientation="Horizontal" HorizontalAlignment="Right">
                                <Button x:Name="SettingsButton" 
                                        Style="{StaticResource ClassroomButton}"
                                        Margin="5" 
                                        Padding="15,0" 
                                        Click="SettingsButton_Click"
                                        ToolTip="Configure R executable path">
                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock Text="⚙️" FontSize="16" Margin="0,0,5,0"/>
                                        <TextBlock Text="R PATH"/>
                                    </StackPanel>
                                </Button>
                                <Button x:Name="BackgroundSettingsButton" 
                                        Style="{StaticResource ClassroomButton}"
                                        Margin="5,5,10,5" 
                                        Padding="15,0" 
                                        Click="BackgroundSettingsButton_Click"
                                        ToolTip="Change application background">
                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock Text="🖼️" FontSize="16" Margin="0,0,5,0"/>
                                        <TextBlock Text="BACKGROUND"/>
                                    </StackPanel>
                                </Button>
                            </StackPanel>
                        </Grid>
                    </Border>
                    <!-- Code Editor and Output Area -->
                    <Grid Grid.Row="1" Margin="10,0,10,0">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="289*"/>
                            <ColumnDefinition Width="861*"/>
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>
                        <!-- Notebook Style Tabs -->
                        <TabControl x:Name="CodeTabsTabControl" 
                                    Grid.Row="0"
                                    Style="{StaticResource {x:Type TabControl}}"
                                    ItemContainerStyle="{StaticResource NotebookTabStyle}"
                                    SelectionChanged="CodeTabsTabControl_SelectionChanged" Grid.ColumnSpan="2">
                            <TabControl.ItemTemplate>
                                <DataTemplate>
                                    <TextBlock Text="{Binding Header}" FontWeight="Medium"/>
                                </DataTemplate>
                            </TabControl.ItemTemplate>
                        </TabControl>
                        <!-- Code Editor and Output Area -->
                        <Grid Grid.Row="1" Grid.ColumnSpan="2">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="8"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <!-- Code Editor Panel with Transparent Background -->
                            <Border x:Name="EditorBorder" Grid.Column="0" 
                                    Background="Transparent"
                                    BorderBrush="{StaticResource MediumGrayBrush}"
                                    BorderThickness="2"
                                    Margin="0,5,5,0"
                                    CornerRadius="8"
                                    Padding="5">
                                <Grid>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="*"/>
                                    </Grid.RowDefinitions>
                                    <Label Grid.Row="0"
                                            Content="📝 Code Editor"
                                            FontSize="20"
                                            FontWeight="Bold"
                                            HorizontalAlignment="Left"
                                            VerticalAlignment="Center"
                                            Foreground="DimGray"
                                           Margin="32,2,0,5"
                                            />
                                    <!-- Spiral Binding Graphic on Left Side -->
                                    <StackPanel Grid.Row="0" Grid.RowSpan="2" HorizontalAlignment="Left" Margin="5,0,0,0" Orientation="Vertical">
                                        <Ellipse Width="12" Height="12" Fill="{StaticResource MediumGrayBrush}" Margin="0,5"/>
                                        <Ellipse Width="12" Height="12" Fill="{StaticResource MediumGrayBrush}" Margin="0,5"/>
                                        <Ellipse Width="12" Height="12" Fill="{StaticResource MediumGrayBrush}" Margin="0,5"/>
                                        <Ellipse Width="12" Height="12" Fill="{StaticResource MediumGrayBrush}" Margin="0,5"/>
                                        <Ellipse Width="12" Height="12" Fill="{StaticResource MediumGrayBrush}" Margin="0,5"/>
                                        <Ellipse Width="12" Height="12" Fill="{StaticResource MediumGrayBrush}" Margin="0,5"/>
                                        <Ellipse Width="12" Height="12" Fill="{StaticResource MediumGrayBrush}" Margin="0,5"/>
                                        <Ellipse Width="12" Height="12" Fill="{StaticResource MediumGrayBrush}" Margin="0,5"/>
                                        <Ellipse Width="12" Height="12" Fill="{StaticResource MediumGrayBrush}" Margin="0,5"/>
                                        <Ellipse Width="12" Height="12" Fill="{StaticResource MediumGrayBrush}" Margin="0,5"/>
                                        <Ellipse Width="12" Height="12" Fill="{StaticResource MediumGrayBrush}" Margin="0,5"/>
                                        <Ellipse Width="12" Height="12" Fill="{StaticResource MediumGrayBrush}" Margin="0,5"/>
                                        <Ellipse Width="12" Height="12" Fill="{StaticResource MediumGrayBrush}" Margin="0,5"/>
                                        <Ellipse Width="12" Height="12" Fill="{StaticResource MediumGrayBrush}" Margin="0,5"/>
                                        <Ellipse Width="12" Height="12" Fill="{StaticResource MediumGrayBrush}" Margin="0,5"/>
                                        <Ellipse Width="12" Height="12" Fill="{StaticResource MediumGrayBrush}" Margin="0,5"/>
                                        <Ellipse Width="12" Height="12" Fill="{StaticResource MediumGrayBrush}" Margin="0,5"/>
                                    </StackPanel>
                                    <!-- Copy Code Button -->
                                    <Button Grid.Row="0" 
                                            BorderThickness="0"
                                            Style="{StaticResource CopyButtonStyle}"
                                            HorizontalAlignment="Right"
                                            VerticalAlignment="Top"
                                            Click="CopyCodeButton_Click"
                                            Width="80"
                                            Height="25"
                                            
                                            ToolTip="Copy Code">
                                        <TextBlock Text="⌨️ copy" FontSize="13"/>
                                    </Button>
                                    <!-- Code Editor with Line Numbers -->
                                    <local:CodeEditorWithLineNumbers x:Name="CodeEditor" 
                                                                     Grid.Row="1" 
                                                                     Margin="25,5,5,5"/>
                                </Grid>
                            </Border>
                            <!-- Splitter -->
                            <GridSplitter Grid.Column="1" 
                                          HorizontalAlignment="Stretch" 
                                          VerticalAlignment="Stretch" 
                                          Background="{StaticResource MediumGrayBrush}"
                                          Margin="0,8"/>
                            <!-- Output Panel with Transparent Background -->
                            <Border x:Name="OutputBorder" Grid.Column="2" 
                                    Background="Transparent"
                                    BorderBrush="{StaticResource MediumGrayBrush}"
                                    BorderThickness="1"
                                    Margin="5,5,0,0"
                                    CornerRadius="2"
                                    Padding="10">
                                <TabControl x:Name="OutputTabControl" >
                                    <TabItem Header="🖥️ CONSOLE">
                                        <Grid>
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="*"/>
                                                <RowDefinition Height="Auto"/>
                                            </Grid.RowDefinitions>
                                            <TextBox x:Name="OutputDisplay" 
                                                     Grid.Row="0" 
                                                     Style="{StaticResource ConsoleOutputStyle}"
                                                     Margin="5"/>
                                            <StackPanel Grid.Row="1" 
                                                        Orientation="Horizontal" 
                                                        HorizontalAlignment="Right" 
                                                        Margin="5">
                                                <Button Content="SAVE OUTPUT" 
                                                        Style="{StaticResource ClassroomButton}"
                                                        Margin="5" 
                                                        Padding="15,0" 
                                                        Click="SaveOutputButton_Click"
                                                        Background="AntiqueWhite"
                                                        ToolTip="Save console output"/>
                                                <Button Style="{StaticResource CopyButtonStyle}"
                                                        Background="Aquamarine"
                                                        Width="80"
                                                        Height="20"
                                                        Click="CopyErrorsButton_Click"
                                                        ToolTip="Copy Errors">
                                                    <TextBlock Text="⌨️ copy" FontSize="15"/>
                                                </Button>
                                            </StackPanel>
                                        </Grid>
                                    </TabItem>
                                    <TabItem Header="📊 PLOT">
                                        <Grid>
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="*"/>
                                                <RowDefinition Height="Auto"/>
                                            </Grid.RowDefinitions>
                                            <ScrollViewer Grid.Row="0" 
                                                          HorizontalScrollBarVisibility="Auto" 
                                                          VerticalScrollBarVisibility="Auto"
                                                          Margin="5">
                                                <Image x:Name="PlotDisplay" 
                                                       Stretch="Uniform"
                                                       RenderOptions.BitmapScalingMode="HighQuality"/>
                                            </ScrollViewer>
                                            <StackPanel Grid.Row="1" 
                                                        Orientation="Horizontal" 
                                                        HorizontalAlignment="Right" 
                                                        Margin="5">
                                                <Button Content="ZOOM IN" 
                                                        Style="{StaticResource ClassroomButton}"
                                                        Margin="5" 
                                                        Padding="15,0" 
                                                        Click="ZoomInPlotButton_Click"
                                                        ToolTip="Zoom in the plot"/>
                                                <Button Content="ZOOM OUT" 
                                                        Style="{StaticResource ClassroomButton}"
                                                        Margin="5" 
                                                        Padding="15,0" 
                                                        Click="ZoomOutPlotButton_Click"
                                                        ToolTip="Zoom out the plot"/>
                                                <Button Content="SAVE PLOT" 
                                                        Style="{StaticResource ClassroomButton}"
                                                        Margin="5" 
                                                        Padding="15,0" 
                                                        Click="SavePlotButton_Click"
                                                        ToolTip="Save plot as image"/>
                                                <Button Content="CLEAR PLOT" 
                                                        Style="{StaticResource ClassroomButton}"
                                                        Margin="5,5,10,5" 
                                                        Padding="15,0" 
                                                        Click="ClearPlotButton_Click"
                                                        ToolTip="Clear current plot"/>
                                            </StackPanel>
                                        </Grid>
                                    </TabItem>
                                    <!-- New AI Assistant Tab -->
                                    <TabItem Header="🤖 AI ASSISTANT">
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="374*"/>
                                                <ColumnDefinition Width="157*"/>
                                            </Grid.ColumnDefinitions>
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="*"/>
                                            </Grid.RowDefinitions>
                                            <!-- AI Service Selection -->
                                            <StackPanel Grid.Row="0" 
                                                        Orientation="Horizontal" 
                                                        Margin="10,10,10,10" Grid.ColumnSpan="2">
                                                <TextBlock Text="Select AI Service:" 
                                                           VerticalAlignment="Center" 
                                                           Margin="0,0,10,0"
                                                           FontFamily="Comic Neue, Kalam"
                                                           FontWeight="Medium"
                                                           Foreground="{StaticResource DarkGrayBrush}"/>
                                                <RadioButton x:Name="ChatGptRadioButton" 
                                                             Content="ChatGPT" 
                                                             GroupName="AIService" 
                                                             IsChecked="True"
                                                             FontFamily="Comic Neue, Kalam"
                                                             Margin="0,0,10,0"
                                                             Foreground="{StaticResource DarkGrayBrush}"
                                                             Checked="AIServiceRadioButton_Checked"/>
                                                <RadioButton x:Name="ClaudeRadioButton" 
                                                             Content="Claude" 
                                                             GroupName="AIService" 
                                                             FontFamily="Comic Neue, Kalam"
                                                             Margin="0,0,10,0"
                                                             Foreground="{StaticResource DarkGrayBrush}"
                                                             Checked="AIServiceRadioButton_Checked"/>
                                            </StackPanel>
                                            <!-- WebView2 Control for AI Assistant -->
                                            <wpf:WebView2 x:Name="AIWebView" 
                                                          Grid.Row="1" 
                                                          Margin="10,10,10,10" Grid.ColumnSpan="2"/>
                                        </Grid>
                                    </TabItem>
                                    <!-- New Notes Tab -->
                                    <TabItem Header="📔 NOTES">
                                        <Grid>
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="*"/>
                                            </Grid.RowDefinitions>
                                            <!-- Toolbar for Notes -->
                                            <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="5">
                                                <Button Content="OPEN NOTE" Style="{StaticResource ClassroomButton}" Margin="5" Padding="15,0" Click="OpenNoteButton_Click" ToolTip="Open a PDF or image file"/>
                                                <Button Content="ZOOM IN" Style="{StaticResource ClassroomButton}" Margin="5" Padding="15,0" Click="ZoomInNoteButton_Click" ToolTip="Zoom in"/>
                                                <Button Content="ZOOM OUT" Style="{StaticResource ClassroomButton}" Margin="5" Padding="15,0" Click="ZoomOutNoteButton_Click" ToolTip="Zoom out"/>
                                                <Button Content="RESET ZOOM" Style="{StaticResource ClassroomButton}" Margin="5" Padding="15,0" Click="ResetZoomNoteButton_Click" ToolTip="Reset zoom"/>
                                            </StackPanel>
                                            <!-- WebView2 for Notes -->
                                            <wpf:WebView2 x:Name="NotesWebView" Grid.Row="1" Margin="5"/>
                                        </Grid>
                                    </TabItem>
                                    <!-- Google Search Tab -->
                                    <TabItem Header="🔍">
                                        <Grid>
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="*"/>
                                            </Grid.RowDefinitions>
                                            <!-- Search Box and Button -->
                                            <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="5">
                                                <TextBox x:Name="GoogleSearchTextBox" 
                     Width="300" 
                     Margin="5"
                     VerticalAlignment="Center"
                     KeyDown="GoogleSearchTextBox_KeyDown"/>
                                                <Button Content="Search" 
                    Style="{StaticResource ClassroomButton}"
                    Margin="5"
                    Click="GoogleSearchButton_Click"
                    ToolTip="Search on Google"/>
                                            </StackPanel>
                                            <!-- WebView2 for Google Search -->
                                            <wpf:WebView2 x:Name="GoogleSearchWebView" 
                      Grid.Row="1" 
                      Margin="5"/>
                                        </Grid>
                                    </TabItem>
                                </TabControl>
                            </Border>
                        </Grid>
                    </Grid>
                </Grid>
                <!-- Status Bar with White Style -->
                <Grid Grid.Row="2">
                    <Border Background="AntiqueWhite"
                            BorderBrush="{StaticResource BlueBrush}" 
                            BorderThickness="0,3,0,0"
                            Margin="10,5,10,0"
                            CornerRadius="12,12,0,0">
                        <Border.Effect>
                            <DropShadowEffect Color="#FF87CEEB" 
                                              ShadowDepth="2" 
                                              Direction="315" 
                                              BlurRadius="6" 
                                              Opacity="0.2"/>
                        </Border.Effect>
                        <StatusBar Style="{StaticResource ClassroomStatusBar}">
                            <StatusBarItem>
                                <TextBlock x:Name="StatusText" 
                                           Text="READY" 
                                           FontWeight="Medium"
                                           FontFamily="Comic Neue, Kalam"/>
                            </StatusBarItem>
                            <Separator Background="{StaticResource MediumGrayBrush}"/>
                            <StatusBarItem>
                                <TextBlock x:Name="ExecutionStatus" 
                                           Text="IDLE" 
                                           FontWeight="Medium"
                                           FontFamily="Comic Neue, Kalam"/>
                            </StatusBarItem>
                            <Separator Background="{StaticResource MediumGrayBrush}"/>
                            <StatusBarItem>
                                <TextBlock x:Name="SessionStatus" 
                                           Text="SESSION SAVED" 
                                           FontWeight="Medium"
                                           FontFamily="Comic Neue, Kalam"/>
                            </StatusBarItem>
                            <Separator Background="{StaticResource MediumGrayBrush}"/>
                            <StatusBarItem>
                                <TextBlock x:Name="LineColumnIndicator" 
                                           Text="LINE: 1, COLUMN: 1" 
                                           FontWeight="Medium"
                                           FontFamily="Comic Neue, Kalam"/>
                            </StatusBarItem>
                            <!--
                            <Separator Background="{StaticResource MediumGrayBrush}"/>
                            -->
                            <Separator Background="PaleGreen"/>
                            <StatusBarItem>
                                <TextBlock x:Name="RPathStatus" 
                                           Text="R PATH: NOT CONFIGURED" 
                                           FontWeight="Medium"
                                           FontFamily="Comic Neue, Kalam"/>
                            </StatusBarItem>
                        </StatusBar>
                    </Border>
                </Grid>
            </Grid>
        </Border>
    </Grid>
</Window>